#!/usr/bin/env bash

source message_functions || exit 1
source locate_files || exit 1
source io_functions || exit 1

sample=$1 && shift

if [[ -z "${sample}" ]]; then
    error "Parameters missing. Exiting."
fi

sample_dir="/data/experiments/charlotte_emc_actionability/database/${sample}"

orange_json="${sample_dir}/${sample}.orange.json"
serve_directory="/data/resources/crunch/actin/cohort_analysis/serve_db"

doid_json="$(locate_doid_json)"

output_directory="${sample_dir}/actin"
create_or_cleanup_dir ${output_directory}

actin_jar="/data/experiments/charlotte_emc_actionability/actin.jar"

info "Running ACTIN ORANGE cohort interpreter on ${sample}"

java -cp ${actin_jar} com.hartwig.actin.molecular.orange.OrangeInterpreterApplication \
    -orange_json "${orange_json}" \
    -serve_directory "${serve_directory}" \
    -doid_json "${doid_json}" \
    -output_directory "${output_directory}" \
    "$@"

